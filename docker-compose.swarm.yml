version: "3.8"

services:
  openclaw:
    image: watink/openclaw:latest
    networks:
      - traefik_net
    deploy:
      mode: replicated
      replicas: 1
      labels:
        - "traefik.enable=true"
        - "traefik.http.routers.openclaw.rule=Host(`${DOMAIN:-openclaw.app.localhost}`)"
        - "traefik.http.routers.openclaw.entrypoints=web"
        - "traefik.http.services.openclaw.loadbalancer.server.port=18789"
        # --- Autenticação (Basic Auth) ---
        # Substitua o hash abaixo pelo seu. Gerar com: htpasswd -nb admin seu_token
        # Exemplo (admin:token123):
        - "traefik.http.middlewares.openclaw-auth.basicauth.users=admin:$$apr1$$9k6o0...$$..."
        - "traefik.http.routers.openclaw.middlewares=openclaw-auth"

        # Configuração TLS/HTTPS (Descomente se necessário)
        # - "traefik.http.routers.openclaw.entrypoints=websecure"
        # - "traefik.http.routers.openclaw.tls=true"
        # - "traefik.http.routers.openclaw.tls.certresolver=myresolver"
    volumes:
      - openclaw_config:/home/openclaw/.openclaw
      - openclaw_workspace:/home/openclaw/workspace
      - openclaw_home:/home/openclaw
      - ./skills:/home/openclaw/workspace/skills

networks:
  traefik_net:
    external: true
    name: ${TRAEFIK_NETWORK:-public}

volumes:
  openclaw_config:
  openclaw_workspace:
  openclaw_home:
